import{S as G,T as O}from"./SearchForm-CbKrYdj9.js";import{W as H}from"./WForm-CS5wZDt4.js";import{_ as U,u as R,a2 as W,b as c,o as I,W as X,w as i,f as $,c as s,g as r,h as f,a3 as A,j as _,k as y,B as z,d as Z,Z as J,E as Q,e as M,a1 as Y,X as L}from"./index-aNIfo854.js";import{c as T}from"./channelStore-CckJZugj.js";import{_ as ee}from"./index-DJiAbVaV.js";import{u as te,_ as oe}from"./index.es-DX6mIkRE.js";import{P as ae}from"./PlusOutlined-B7gLAiVd.js";import{_ as ne}from"./index-BGzNgi0h.js";import"./index-XsA9DfIQ.js";import"./Col-B8w7Ubqz.js";import"./debounce-DJi5mwmY.js";import"./index-D_uLXcOy.js";import"./List-DoRPfoeT.js";import"./index-BYU4Xr3M.js";import"./index-eE3Tj_Ig.js";import"./index-B6yYNcnT.js";import"./ActionButton-k2dsG7sK.js";const se={class:"footer"},le={__name:"Edit",emits:["success"],setup(F,{expose:b,emit:D}){const{SEND_MESSAGE:h}=R(),{channelData:v}=W(T()),l=c(!1),C=c(""),u=c({}),d=c(!1),E=D,N=()=>{const a={type:"setMediaChannelInfo",...u.value};if(!a.mediaId&&a.mediaId!=0){const t=v.value.find(p=>p.mediaDelete==1);t&&(a.mediaId=t.mediaId)}_.on(a.type,t=>{t.result===0?(y.success("æ“ä½œæˆåŠŸ"),l.value=!1,E("success")):y.error("è¯·æ±‚å¤±è´¥"),_.off(a.type),d.value=!1}),d.value=!0,h(a)},w=[{type:"input",label:"è§†é¢‘åœ°å€",key:"mediaUrl"},{type:"input",label:"ç›¸æœºç¼–å·",key:"mediaName"},{type:"textarea",label:"ç›¸æœºæè¿°",key:"mediaDesc"}],m=a=>{C.value=a?"ç¼–è¾‘":"æ–°å¢ž",u.value=a||{},l.value=!0,d.value=!1},x=()=>{l.value=!1};return b({showDrawer:m}),(a,t)=>{const p=z,B=ee;return I(),X(B,{open:r(l),"onUpdate:open":t[1]||(t[1]=g=>A(l)?l.value=g:null),title:r(C),width:"520","footer-style":{textAlign:"right"},onClose:x},{footer:i(()=>[$("div",se,[s(p,{type:"primary",onClick:N,loading:r(d)},{default:i(()=>t[2]||(t[2]=[f("ç¡®è®¤")])),_:1},8,["loading"]),s(p,{class:"close",onClick:x},{default:i(()=>t[3]||(t[3]=[f("å–æ¶ˆ")])),_:1})])]),default:i(()=>[s(H,{modelValue:r(u),"onUpdate:modelValue":t[0]||(t[0]=g=>A(u)?u.value=g:null),formList:w,labelWidth:"100px"},null,8,["modelValue"])]),_:1},8,["open","title"])}}},ie=U(le,[["__scopeId","data-v-4f437229"]]),re={class:"channel-container"},ue={style:{display:"flex","justify-content":"end","margin-bottom":"20px"}},de={key:0},ce={key:1},me={__name:"index",setup(F){const{SEND_MESSAGE:b}=R(),{SET_CHANNEL_DATA:D}=T(),{channelData:h}=W(T()),v=c([]),l=c(0),C=Z(()=>({total:l.value,current:N.value,pageSize:w.value})),u=()=>{const o={type:"getMediaChannelList"};_.on(o.type,e=>{if(e.result===0){console.log("ðŸš€ ~ bus.on ~ res:",e);const n=e.data.channels;D(n),console.log(h.value),v.value=h.value.filter(k=>k.mediaDelete==0),l.value=v.value.length}else y.error("è¯·æ±‚å¤±è´¥");_.off(o.type)}),b(o)},{run:d,loading:E,current:N,pageSize:w}=te(u,{formatResult:o=>{console.log(o,"run==========")},pagination:{currentKey:"page",pageSizeKey:"results"}});let m=null;const x=()=>{m&&clearInterval(m),m=setInterval(()=>{console.log("äº”ç§’ä¸€æ¬¡"),d()},5e3)};J(()=>{x()}),Q(()=>{clearInterval(m)});const a=c(""),t=(o=null)=>{a.value.showDrawer(o)},p=(o,e)=>{if(console.log("ðŸš€ ~ handleDelete ~ mediaStatus:",e),e==2){y.error("é€šé“è¢«ä½¿ç”¨ï¼Œè¯·å…ˆåˆ é™¤ç›¸å…³ä»»åŠ¡");return}const n={type:"delMediaChannelInfo",mediaId:o};_.on(n.type,k=>{k.result===0?(y.success("æ“ä½œæˆåŠŸ"),d()):y.error("è¯·æ±‚å¤±è´¥"),_.off(n.type)}),b(n)},B=(o,e,n)=>{console.log("ðŸš€ ~ handleTableChange ~ pag, filters, sorter:",o,e,n),d({results:o.pageSize,page:o==null?void 0:o.current,sortField:n.field,sortOrder:n.order,...e})},g=[{type:"input",key:"keyWord",label:"ç›¸æœºç¼–å·"},{type:"select",key:"screenKey",label:"é€šé“çŠ¶æ€",list:[{value:"name",label:"åˆ†ç»„åç§°"},{value:"description",label:"æè¿°"}]}],K=[{title:"ç›¸æœºç¼–å·",dataIndex:"mediaId",key:"mediaName"},{title:"è§†é¢‘åœ°å€",dataIndex:"mediaUrl",key:"mediaUrl"},{title:"é€šé“çŠ¶æ€",key:"mediaStatus",dataIndex:"mediaStatus"},{title:"æ“ä½œ",key:"action"}];return(o,e)=>{const n=z,k=O,P=ne,j=oe;return I(),M("div",re,[s(G,{searchList:g}),$("div",ue,[s(n,{type:"primary",onClick:t,disabled:r(l)>=16},{default:i(()=>[s(r(ae)),e[1]||(e[1]=f("æ–°å»º "))]),_:1},8,["disabled"])]),s(j,{columns:K,"data-source":r(v),pagination:r(C),loading:r(E),onChange:B,scroll:{x:!0,y:520}},{bodyCell:i(({column:V,record:S})=>[V.key==="mediaStatus"?(I(),M("span",de,[s(k,{color:S.mediaStatus?"green":"volcano"},{default:i(()=>[f(Y(S.mediaStatus?"æ­£å¸¸":"å¼‚å¸¸"),1)]),_:2},1032,["color"])])):L("",!0),V.key==="action"?(I(),M("span",ce,[s(n,{type:"link",onClick:q=>t(S)},{default:i(()=>e[2]||(e[2]=[f("ç¼–è¾‘")])),_:2},1032,["onClick"]),s(P,{title:"æ˜¯å¦ç¡®å®šåˆ é™¤è¯¥æ•°æ®?",onConfirm:q=>p(S.mediaId,S.mediaStatus),onCancel:e[0]||(e[0]=()=>{})},{default:i(()=>[s(n,{type:"link"},{default:i(()=>e[3]||(e[3]=[f("åˆ é™¤")])),_:1})]),_:2},1032,["onConfirm"])])):L("",!0)]),_:1},8,["data-source","pagination","loading"]),s(ie,{ref_key:"editRef",ref:a,onSuccess:u},null,512)])}}},Be=U(me,[["__scopeId","data-v-4e14fc07"]]);export{Be as default};
