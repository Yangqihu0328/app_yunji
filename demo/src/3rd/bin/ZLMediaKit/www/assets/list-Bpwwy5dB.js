import{S as R,T as W}from"./SearchForm-CW-aKEMV.js";import{u as j,D as F,_ as G}from"./index.es-C_kbu2Qc.js";import{_ as H,u as J,a0 as Q,a as b,b as X,o as _,d as f,c as s,e as g,w as o,f as p,g as r,$ as h,V as v,i,j as d,h as Y,B as Z,a4 as tt}from"./index-ZFhHKPxY.js";import{c as T}from"./channelStore-Dfo67YHm.js";import{P as et}from"./PlusOutlined-CSdKcCeR.js";import{D as at}from"./index-CWWnDwEB.js";import{_ as st}from"./index-B382VTBM.js";import"./index-1s2OQizq.js";import"./Col-C9jpydrb.js";import"./debounce-BZQqrQHQ.js";import"./index-R7dzPPIl.js";import"./List-Dsenz6Ny.js";import"./index-Cu5367wT.js";import"./ActionButton-BRf9LzwW.js";const ot={class:"channel-container"},nt={class:"add_btn"},lt={key:0},it={key:1},rt={key:2},dt={class:"option"},ut={__name:"list",setup(pt){const{SEND_MESSAGE:m}=J();Q(T());const{GET_CHANNEL_DATA:D}=T(),x=b([]),N=b(0),w=X(()=>({total:N.value,current:M.value,pageSize:B.value})),k=()=>{const e={type:"getAlgoTaskList"};i.on(e.type,t=>{if(t.result===0||t.msg){const a=t.data.tasks;x.value=a.filter(n=>n.taskDelete!=1)}else d.error("è¯·æ±‚å¤±è´¥");i.off(e.type)}),m(e)};let S=[];(()=>{const e={type:"getAiModelList"};i.on(e.type,t=>{t.result===0||t.msg?S=t.data.models:d.error("è¯·æ±‚å¤±è´¥"),i.off(e.type)}),m(e)})();const E=e=>e.map(a=>{const n=S.find(y=>y.modelId==a);return n?n.modelName:""}).join("ï¼Œ"),{run:L,loading:u,current:M,pageSize:B}=j(k,{formatResult:e=>e.data.results,pagination:{currentKey:"page",pageSizeKey:"results"}}),C=Y(),I=async(e=null)=>{await D(),setTimeout(()=>{console.log("ðŸš€ ~ handleEdit ~ id:",e),e!=null?C.push({path:"/task/edit",query:{id:e}}):C.push("/task/edit")},0)},P=e=>{const t={type:"delAlgoTaskInfo",mediaId:e,controlCommand:2};i.on(t.type,a=>{a.result===0||a.msg?(d.success("æ“ä½œæˆåŠŸ"),k()):d.error("è¯·æ±‚å¤±è´¥"),u.value=!1,i.off(t.type)}),u.value=!0,m(t)},V=(e,t)=>{const a={type:"algoTaskControl",mediaId:e,controlCommand:t?1:0};i.on(a.type,n=>{n.result===0||n.msg?(d.success("æ“ä½œæˆåŠŸ"),k()):d.error("è¯·æ±‚å¤±è´¥"),u.value=!1,i.off(a.type)}),u.value=!0,m(a)},$=(e,t,a)=>{console.log("ðŸš€ ~ handleTableChange ~ pag, filters, sorter:",e,t,a),L({results:e.pageSize,page:e==null?void 0:e.current,sortField:a.field,sortOrder:a.order,...t})},z=[{type:"input",key:"keyWord",label:"ä»»åŠ¡ç¼–å·"},{type:"select",key:"screenKey",label:"ä»»åŠ¡çŠ¶æ€",list:[{value:"name",label:"åˆ†ç»„åç§°"},{value:"description",label:"æè¿°"}]}],U=[{title:"ä»»åŠ¡ç¼–å·",dataIndex:"taskName",key:"taskName",width:180},{title:"è§†é¢‘æº",dataIndex:"mediaUrl",key:"mediaUrl",maxWidth:200,ellipsis:!0},{title:"ä¸ŠæŠ¥åœ°å€",dataIndex:"taskPushUrl",key:"taskPushUrl",maxWidth:200,ellipsis:!0},{title:"ç®—æ³•é…ç½®ä¿¡æ¯",dataIndex:"taskAlgos",key:"taskAlgos",width:180},{title:"ä»»åŠ¡çŠ¶æ€",dataIndex:"taskStatus",key:"taskStatus",fixed:"right",width:180},{title:"æ“ä½œ",dataIndex:"action",key:"action",fixed:"right"}];return(e,t)=>{const a=Z,n=W,y=st,q=tt,K=F,O=G;return _(),f("div",ot,[s(R,{searchList:z}),g("div",nt,[s(a,{type:"primary",onClick:t[0]||(t[0]=c=>I(null)),style:{padding:"0 15px"}},{default:o(()=>[s(p(et)),t[2]||(t[2]=r("æ–°å»º "))]),_:1})]),s(O,{columns:U,"data-source":p(x),pagination:p(w),loading:p(u),scroll:{x:!0,y:560},onChange:$},{bodyCell:o(({column:c,record:l})=>[c.dataIndex==="taskStatus"?(_(),f("span",lt,[s(n,{color:l.taskStatus?"green":"volcano"},{default:o(()=>[r(h(l.taskStatus?"è¿è¡Œä¸­":"æœªè¿è¡Œ"),1)]),_:2},1032,["color"])])):v("",!0),c.dataIndex==="taskAlgos"?(_(),f("span",it,h(E(l.taskAlgos)),1)):v("",!0),c.dataIndex==="action"?(_(),f("span",rt,[s(a,{type:"link",onClick:A=>I(l.mediaId)},{default:o(()=>t[3]||(t[3]=[r("ç¼–è¾‘")])),_:2},1032,["onClick"]),s(a,{type:"link",onClick:A=>V(l.mediaId,l.taskStatus)},{default:o(()=>[r(h(l.taskStatus?"å…³é—­":"å¯åŠ¨"),1)]),_:2},1032,["onClick"]),s(K,null,{overlay:o(()=>[s(q,null,{default:o(()=>[g("div",dt,[s(y,{title:"æ˜¯å¦ç¡®å®šåˆ é™¤è¯¥æ•°æ®?",onConfirm:A=>P(l.mediaId),onCancel:t[1]||(t[1]=()=>{})},{default:o(()=>[s(a,{type:"link"},{default:o(()=>t[4]||(t[4]=[r(" åˆ é™¤ ")])),_:1})]),_:2},1032,["onConfirm"]),s(a,{type:"link",disabled:""},{default:o(()=>t[5]||(t[5]=[r("é…ç½®åŒºåŸŸ")])),_:1})])]),_:2},1024)]),default:o(()=>[g("a",null,[t[6]||(t[6]=r(" æ›´å¤š ")),s(p(at))])]),_:2},1024)])):v("",!0)]),_:1},8,["data-source","pagination","loading"])])}}},Tt=H(ut,[["__scopeId","data-v-5357631f"]]);export{Tt as default};
