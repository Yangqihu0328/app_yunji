import{_ as V,b as f,r as W,o as C,T as q,w as i,f as a,c as n,h as _,g as r,a0 as S,B as F,u as K,au as Q,d as Y,e as U,F as tt,W as et,Z as D,X as $,j as u,k as b,aq as st,ap as at}from"./index-BvjWryS2.js";import{S as ot,T as lt}from"./SearchForm-fFmZQFLM.js";import{_ as nt}from"./Title--qau-cKE.js";import{W as it}from"./WForm-BrNPQpQF.js";import{_ as rt}from"./index-DsVdfQI2.js";import{c as ct}from"./channelStore-Dslrivyn.js";import{_ as dt}from"./index-DSyo-FdW.js";import{a as ut,_ as mt}from"./index-CjjNimhK.js";import"./index-Bgn2GKDE.js";import"./Col-DGIuxiBu.js";import"./debounce-BKGNfoRD.js";import"./index-CLBl60Qf.js";import"./List-BorunFM5.js";const pt=["src"],_t=["src"],ft={class:"footer"},gt={__name:"Detail",setup(j,{expose:v}){const m=f({}),y=f(!1);f("警告原图"),f(!1);const M=h=>{m.value=h,y.value=!0},g=()=>{y.value=!1},k=[{type:"text",label:"告警类别",key:"alarmType"},{type:"text",label:"告警标识",key:"alarmId"},{type:"text",label:"视频通道",key:"mediaName"},{type:"text",label:"上报情况",key:"pushStatus"},{type:"slot",label:"抓拍图",key:"Path"}];return W(["警告原图","前端标注图",{value:"后端标注图",disabled:!0}]),v({showDrawer:M}),(h,p)=>{const w=nt,A=F,E=rt;return C(),q(E,{open:r(y),"onUpdate:open":p[1]||(p[1]=x=>S(y)?y.value=x:null),title:"告警详情",width:"48%","footer-style":{textAlign:"right"},onClose:g},{footer:i(()=>[a("div",ft,[n(A,{class:"close",onClick:g},{default:i(()=>p[2]||(p[2]=[_("取消")])),_:1})])]),default:i(()=>[n(w,{title:"告警明细",class:"detail-info-title"}),n(it,{modelValue:r(m),"onUpdate:modelValue":p[0]||(p[0]=x=>S(m)?m.value=x:null),formList:k,labelWidth:"100px"},{Path:i(()=>[a("img",{src:r(m).Path,style:{width:"200px"}},null,8,pt)]),_:1},8,["modelValue"]),n(w,{title:"告警预览",class:"detail-info-title title"}),a("img",{src:r(m).Path,style:{width:"100%"}},null,8,_t)]),_:1},8,["open"])}}},vt=V(gt,[["__scopeId","data-v-7158977c"]]),yt={class:"alarm-container"},kt={class:"alarm-box"},ht={class:"flex"},bt=["src"],xt={class:"item-label"},Nt={class:"item"},Dt={class:"content"},St={class:"item"},wt={class:"content"},Tt={class:"item"},Lt={class:"content"},Ct={class:"item"},Mt={class:"item-alarm"},At={class:"content"},Et={class:"footer"},zt={class:"footer-delete"},Bt={class:"select-text"},$t={__name:"index",setup(j){const{SEND_MESSAGE:v}=K();ct();const{alarmData:m,DELETE_ALARM:y,DELETE_ALL_ALARM:M}=Q(),g=f([]),k=f(12),h=f(1),p=W({taskName:"",mediaName:"",Time:[],alarmMsg:""}),w=Y(()=>{const{taskName:e,mediaName:t,Time:d,alarmMsg:l}=p,s=m.filter(N=>{let c=!0;if(e&&(c=c&&N.taskName.includes(e)),t&&(c=c&&N.mediaName.includes(t)),d&&d.length===2){const[o,B]=d,Z=$(o+" 00:00:00"),H=$(B+" 23:59:59"),R=$(N.Time);c=c&&R.isAfter(Z)&&R.isBefore(H)}return l&&(c=c&&N.alarmMsg===l),c}),L=(h.value-1)*k.value,z=L+k.value;return s.slice(L,z)}),A=e=>{Object.assign(p,e)},E=(e,t)=>{console.log(e,t)},x=f(""),I=e=>{x.value.showDrawer(e)},P=e=>{const t=e.map(s=>s.jpgPath),d=e.map(s=>s.id),l={type:"clearJpgFiles",fileUrls:t};u.on(l.type,s=>{s.result===0?(b.success(s.msg),y(d)):b.error(s.msg),u.off(l.type)}),v(l)},J=()=>{const e={type:"clearAllJpg"};u.on(e.type,t=>{t.result===0?(b.success(t.msg),M()):b.error(t.msg),u.off(e.type)}),v(e)},T=f([{type:"select",key:"taskName",label:"警告任务",list:[]},{type:"select",key:"mediaName",label:"视频通道",list:[]},{type:"range",key:"Time",label:"警告时间"},{type:"select",key:"alarmMsg",label:"警告内容",list:[]}]),G=()=>{const e={type:"getMediaChannelList"};u.on(e.type,t=>{if(t.result===0){const l=t.data.channels.filter(s=>s.mediaDelete==0).map(s=>({label:s.mediaName,value:s.mediaName}));T.value[1].list=l}else b.error(t.msg);u.off(e.type)}),v(e)},O=()=>{const e={type:"getAiModelList"};u.on(e.type,t=>{if(t.result===0||t.msg){const l=t.data.models.map(s=>({label:s.modelWarning,value:s.modelWarning}));T.value[3].list=l}else b.error(t.msg);u.off(e.type)}),v(e)},X=()=>{const e={type:"getAlgoTaskList"};u.on(e.type,t=>{if(t.result===0||t.msg){const l=t.data.tasks.filter(s=>s.taskDelete!=1).map(s=>({label:s.taskName,value:s.taskName}));T.value[0].list=l}else b.error(t.msg);u.off(e.type)}),v(e)};return G(),X(),O(),(e,t)=>{const d=at,l=F,s=lt,L=mt,z=ut,N=st,c=dt;return C(),U("div",yt,[n(ot,{searchList:r(T),isRow:!0,span:5,data:{taskName:null,mediaName:null,Time:null,alarmMsg:null},onChange:A},null,8,["searchList"]),n(N,{value:r(g),"onUpdate:value":t[0]||(t[0]=o=>S(g)?g.value=o:null),style:{width:"100%"}},{default:i(()=>[n(z,{gutter:16,style:{width:"100%"}},{default:i(()=>[(C(!0),U(tt,null,et(r(w),o=>(C(),q(L,{class:"gutter-row",xs:24,sm:12,md:8,lg:6,key:o.id},{default:i(()=>[a("div",kt,[a("div",ht,[n(d,{value:o,class:"flex1"},{default:i(()=>[_(" 告警任务: "+D(o.taskName),1)]),_:2},1032,["value"]),n(l,{type:"link",text:"",onClick:B=>I(o)},{default:i(()=>t[4]||(t[4]=[_(" 详情 ")])),_:2},1032,["onClick"])]),a("img",{class:"icon",src:o.Path},null,8,bt),a("div",xt,[a("div",Nt,[t[5]||(t[5]=a("div",null,"视频通道：",-1)),a("div",Dt,D(o.mediaName),1)]),a("div",St,[t[6]||(t[6]=a("div",null,"告警时间：",-1)),a("div",wt,D(o.Time),1)]),a("div",Tt,[t[7]||(t[7]=a("div",null,"上报状态：",-1)),a("div",Lt,D(o.pushStatus),1)]),a("div",Ct,[t[9]||(t[9]=a("div",null,"告警内容：",-1)),a("div",Mt,[a("div",At,[n(s,{color:"orange"},{default:i(()=>[_(D(o.alarmMsg),1)]),_:2},1024)]),n(l,{danger:"",class:"delete",onClick:B=>P([o])},{default:i(()=>t[8]||(t[8]=[_(" 删除 ")])),_:2},1032,["onClick"])])])])])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"]),a("div",Et,[a("div",zt,[a("span",null,[t[10]||(t[10]=_("已选 ")),a("span",Bt,D(r(g).length),1),t[11]||(t[11]=_("项"))]),n(l,{type:"primary",class:"footer-btn left",onClick:t[1]||(t[1]=o=>P(r(g)))},{default:i(()=>t[12]||(t[12]=[_(" 删除选中 ")])),_:1}),n(l,{class:"close footer-btn",onClick:J},{default:i(()=>t[13]||(t[13]=[_(" 清空全部 ")])),_:1})]),n(c,{current:r(h),"onUpdate:current":t[2]||(t[2]=o=>S(h)?h.value=o:null),pageSize:r(k),"onUpdate:pageSize":t[3]||(t[3]=o=>S(k)?k.value=o:null),"show-size-changer":"",total:r(m).length,"page-size-options":["12","24","36","48","60"],onShowSizeChange:E},null,8,["current","pageSize","total"])]),n(vt,{ref_key:"detailRef",ref:x},null,512)])}}},Zt=V($t,[["__scopeId","data-v-42373184"]]);export{Zt as default};
